<?xml version="1.0" encoding="UTF-8"?>
<svg width="600" height="900" viewBox="0 0 600 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Definiciones -->
  <defs>
    <style>
      .box { fill: #E3F2FD; stroke: #1976D2; stroke-width: 2; }
      .decision { fill: #FFF3E0; stroke: #F57C00; stroke-width: 2; }
      .process { fill: #E8F5E8; stroke: #388E3C; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; }
      .arrow { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Título -->
  <text x="300" y="30" class="text" font-size="16" font-weight="bold">Diagrama de Flujo - Preprocesamiento de Texto</text>
  
  <!-- Inicio -->
  <ellipse cx="300" cy="70" rx="60" ry="25" class="box"/>
  <text x="300" y="75" class="text">INICIO</text>
  
  <!-- Entrada de texto -->
  <rect x="220" y="120" width="160" height="40" class="box"/>
  <text x="300" y="135" class="text">Recibir texto de entrada</text>
  <text x="300" y="150" class="text">Cargar stopwords</text>
  
  <!-- Convertir a minúsculas -->
  <rect x="220" y="190" width="160" height="30" class="process"/>
  <text x="300" y="210" class="text">texto = texto.lower()</text>
  
  <!-- Eliminar puntuación -->
  <rect x="220" y="250" width="160" height="40" class="process"/>
  <text x="300" y="265" class="text">Eliminar signos de</text>
  <text x="300" y="280" class="text">puntuación</text>
  
  <!-- Tokenizar -->
  <rect x="220" y="320" width="160" height="30" class="process"/>
  <text x="300" y="340" class="text">tokens = word_tokenize()</text>
  
  <!-- Inicializar lista filtrada -->
  <rect x="220" y="380" width="160" height="30" class="process"/>
  <text x="300" y="400" class="text">filtered_tokens = []</text>
  
  <!-- Inicializar contador -->
  <rect x="220" y="440" width="160" height="30" class="process"/>
  <text x="300" y="460" class="text">i = 0</text>
  
  <!-- Condición del bucle -->
  <polygon points="300,500 350,530 300,560 250,530" class="decision"/>
  <text x="300" y="530" class="text">i < len(tokens)?</text>
  
  <!-- Verificar si es stopword -->
  <polygon points="300,600 380,630 300,660 220,630" class="decision"/>
  <text x="300" y="625" class="text">tokens[i] en</text>
  <text x="300" y="640" class="text">stopwords?</text>
  
  <!-- Verificar si es alfabético -->
  <polygon points="450,600 530,630 450,660 370,630" class="decision"/>
  <text x="450" y="625" class="text">tokens[i]</text>
  <text x="450" y="640" class="text">isalpha()?</text>
  
  <!-- Agregar token -->
  <rect x="370" y="700" width="160" height="40" class="process"/>
  <text x="450" y="715" class="text">filtered_tokens.append</text>
  <text x="450" y="730" class="text">(tokens[i])</text>
  
  <!-- Incrementar contador -->
  <rect x="220" y="780" width="160" height="30" class="process"/>
  <text x="300" y="800" class="text">i = i + 1</text>
  
  <!-- Aplicar stemming -->
  <rect x="420" y="500" width="160" height="40" class="process"/>
  <text x="500" y="515" class="text">Aplicar stemming a</text>
  <text x="500" y="530" class="text">filtered_tokens</text>
  
  <!-- Retornar resultado -->
  <rect x="420" y="570" width="160" height="30" class="box"/>
  <text x="500" y="590" class="text">return filtered_tokens</text>
  
  <!-- Fin -->
  <ellipse cx="500" cy="640" rx="40" ry="20" class="box"/>
  <text x="500" y="645" class="text">FIN</text>
  
  <!-- Flechas principales -->
  <line x1="300" y1="95" x2="300" y2="120" class="arrow"/>
  <line x1="300" y1="160" x2="300" y2="190" class="arrow"/>
  <line x1="300" y1="220" x2="300" y2="250" class="arrow"/>
  <line x1="300" y1="290" x2="300" y2="320" class="arrow"/>
  <line x1="300" y1="350" x2="300" y2="380" class="arrow"/>
  <line x1="300" y1="410" x2="300" y2="440" class="arrow"/>
  <line x1="300" y1="470" x2="300" y2="500" class="arrow"/>
  
  <!-- Sí desde condición del bucle -->
  <line x1="300" y1="560" x2="300" y2="600" class="arrow"/>
  <text x="310" y="580" class="text" font-size="10">Sí</text>
  
  <!-- No desde condición del bucle -->
  <line x1="350" y1="530" x2="420" y2="530" class="arrow"/>
  <line x1="420" y1="530" x2="420" y2="500" class="arrow"/>
  <text x="385" y="525" class="text" font-size="10">No</text>
  
  <!-- No es stopword -->
  <line x1="380" y1="630" x2="450" y2="630" class="arrow"/>
  <text x="415" y="625" class="text" font-size="10">No</text>
  
  <!-- Es alfabético -->
  <line x1="450" y1="660" x2="450" y2="700" class="arrow"/>
  <text x="460" y="680" class="text" font-size="10">Sí</text>
  
  <!-- Desde agregar token -->
  <line x1="450" y1="740" x2="450" y2="760" class="arrow"/>
  <line x1="450" y1="760" x2="300" y2="760" class="arrow"/>
  <line x1="300" y1="760" x2="300" y2="780" class="arrow"/>
  
  <!-- Bucle de vuelta -->
  <line x1="300" y1="810" x2="300" y2="830" class="arrow"/>
  <line x1="300" y1="830" x2="50" y2="830" class="arrow"/>
  <line x1="50" y1="830" x2="50" y2="530" class="arrow"/>
  <line x1="50" y1="530" x2="250" y2="530" class="arrow"/>
  
  <!-- Desde stemming -->
  <line x1="500" y1="540" x2="500" y2="570" class="arrow"/>
  <line x1="500" y1="600" x2="500" y2="620" class="arrow"/>
  
  <!-- Etiquetas adicionales -->
  <text x="230" y="625" class="text" font-size="10">Sí</text>
  <text x="370" y="625" class="text" font-size="10">No</text>
  
  <!-- Salto directo cuando es stopword o no alfabético -->
  <line x1="220" y1="630" x2="150" y2="630" class="arrow"/>
  <line x1="150" y1="630" x2="150" y2="760" class="arrow"/>
  <line x1="150" y1="760" x2="220" y2="760" class="arrow"/>
  
  <line x1="370" y1="630" x2="320" y2="630" class="arrow"/>
  <line x1="320" y1="630" x2="320" y2="760" class="arrow"/>
  <line x1="320" y1="760" x2="300" y2="760" class="arrow"/>
  
</svg>